<!DOCTYPE html>
<html>
	<head>	
		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1.0" name="viewport">
		<title>Productos</title>
		<link rel="icon" type="image/png" href="img/iconopag.png">
		<link rel="stylesheet" type="text/css" href="css/Estilos-ProyectoHW.css">
		<link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-icons.css">
		<!-- CSS only -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
		<script src="https://kit.fontawesome.com/5748b3ed94.js" crossorigin="anonymous"></script> <!--libreria de fontawesome. NO LA VAYAN A CAGAR-->
	
	</head>
	
	<body>
		<div>
			<div class="principal" id="cPrincipal">
				<!--Inicia NAV -->
				<nav class="navbar navbar-expand-lg navbar-light shadow-sm py-3 py-lg-0 px-3 px-lg-0">
					<a href="index.html" class="navbar-brand ms-lg-5">
						<h1 class="m-0 text-uppercase">
							<i class="fa-solid fa-bezier-curve" style="color: green"></i>
							<!-- <i class="bi bi-shop fs-1 text-success me-3"></i> -->
								hijos del maix
						</h1>
					</a>
					<button class="Dmode" id="Dmode">
						<span><i class="fa-sharp fa-solid fa-sun DmodeON" id="DmodeON"></i></span>
						<span><i class="fa-solid fa-moon" id="DmodeOF"></i></span>
					</button>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
						<span class="navbar-toggler-icon"></span>
					</button>					
					<div class="collapse navbar-collapse" id="navbarCollapse">
						<div class="navbar-nav ms-auto py-0">
							<a href="index.html" class="nav-item nav-link">Principal</a>
							<a href="acercaDe.html" class="nav-item nav-link">Acerca de Nosotros</a>
							<a href="Productos.html" class="nav-item nav-link active activeNav">Productos</a>
							<a href="servicios.html" class="nav-item nav-link lt">Planes</a>							
							<a href="#" class="nav-link bg-success text-white px-5 ms-lg-4 container-cart-icon">
								<i class="bi bi-cart4"></i>
								Carrito
								<i class="bi bi-caret-right-fill"></i>
								
								<span id="contador-productos">0</span>
								
							</a>
							<div class="container-icon"><!--Barra de productos oculta-->
								<div class="container-cart-products hidden-cart">
									<div class="row-product hidden">
										<div class="cart-product">
											<div class="info-cart-product"></div>						
										</div>
									</div>
									<div class="cart-total hidden">
										<h3>Total:</h3>
										<span class="total-pagar">$0</span>
									</div>
									<p class="cart-empty">El carrito está vacío</p>
								</div>
							</div>
						</div>
					</div>
				</nav>
				<!--FIN NAV -->
		<div class="container-fluid">
		<div class="row mt-5 container-items">
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p1.png"
						alt="producto"
						class="img-fluid"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 1</h2>
					<p class="price">$120</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p2.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 2</h2>
					<p class="price">$320</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p3.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 3</h2>
					<p class="price">$500</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p4.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 4</h2>
					<p class="price">$999</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p5.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 5</h2>
					<p class="price">$260</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p6.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 6</h2>
					<p class="price">$90</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p7.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 7</h2>
					<p class="price">$775</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
			<div class="item col-lg-3 col-md-4 col-sm-12">
				<figure>
					<img
						src="img/Productos/p8.png"
						alt="producto"
					/>
				</figure>
				<div class="info-product">
					<h2>Producto 8</h2>
					<p class="price">$410</p>
					<button class="btn-add-cart bg-success">Añadir al carrito</button>
				</div>
			</div>
		</div>
		</div>
		
				<!-- Inicia pie -->
				<footer class="pie-pagina container-fluid">
					<h6 class="text-uppercase">
						&copy; hijos del maix
					</h6>					
					<a href="#" class="iconoFace"><i class="fa-brands fa-square-facebook fa-2x"></i></a>
					<a href="#" class="iconotwitter"><i class="fa-brands fa-square-twitter fa-2x"></i></a>
					<i class="fa-brands fa-square-instagram fa-2x iconoInsta"></i>
					<div>
						<span class="text-link">Terms & Conditions</span>
						<span class="mx-1">|</span>
						<span class="text-link">Privacy Policy</span>
						<span class="mx-1">|</span>
						<span class="text-link">Customer Support</span>
						<span class="mx-1">|</span>
						<span class="text-link">Payments</span>
						<span class="mx-1">|</span>
						<span class="text-link">Help</span>
						<span class="mx-1">|</span>
						<span class="text-link">FAQs</span>
					</div>
				</footer>
				<!-- Fin pie -->
			</div>
		</div>
		<script type="text/javascript" src="js/pyHW.js"></script>
		<script type="text/javascript" src="css/bootstrap/js/bootstrap.bundle.js"></script>
	</body>
</html>
<script>
const btnCart = document.querySelector('.container-cart-icon');
const containerCartProducts = document.querySelector(
	'.container-cart-products'
);

btnCart.addEventListener('click', () => {
	containerCartProducts.classList.toggle('hidden-cart');
});

/* ========================= */
const cartInfo = document.querySelector('.cart-product');
const rowProduct = document.querySelector('.row-product');

// Lista de todos los contenedores de productos
const productsList = document.querySelector('.container-items');

// Variable de arreglos de Productos
let allProducts = [];

const valorTotal = document.querySelector('.total-pagar');

const countProducts = document.querySelector('#contador-productos');

const cartEmpty = document.querySelector('.cart-empty');
const cartTotal = document.querySelector('.cart-total');

productsList.addEventListener('click', e => {
	if (e.target.classList.contains('btn-add-cart')) {
		const product = e.target.parentElement;

		const infoProduct = {
			quantity: 1,
			title: product.querySelector('h2').textContent,
			price: product.querySelector('p').textContent,
		};

		const exits = allProducts.some(
			product => product.title === infoProduct.title
		);

		if (exits) {
			const products = allProducts.map(product => {
				if (product.title === infoProduct.title) {
					product.quantity++;
					return product;
				} else {
					return product;
				}
			});
			allProducts = [...products];
		} else {
			allProducts = [...allProducts, infoProduct];
		}

		showHTML();
	}
});

rowProduct.addEventListener('click', e => {
	if (e.target.classList.contains('icon-close')) {
		const product = e.target.parentElement;
		const title = product.querySelector('p').textContent;

		allProducts = allProducts.filter(
			product => product.title !== title
		);

		console.log(allProducts);

		showHTML();
	}
});

// Funcion para mostrar  HTML
const showHTML = () => {
	if (!allProducts.length) {
		cartEmpty.classList.remove('hidden');
		rowProduct.classList.add('hidden');
		cartTotal.classList.add('hidden');
	} else {
		cartEmpty.classList.add('hidden');
		rowProduct.classList.remove('hidden');
		cartTotal.classList.remove('hidden');
	}

	// Limpiar HTML
	rowProduct.innerHTML = '';

	let total = 0;
	let totalOfProducts = 0;

	allProducts.forEach(product => {
		const containerProduct = document.createElement('div');
		containerProduct.classList.add('cart-product');

		containerProduct.innerHTML = `
            <div class="info-cart-product">
                <span class="cantidad-producto-carrito">${product.quantity}</span>
                <p class="titulo-producto-carrito">${product.title}</p>
                <span class="precio-producto-carrito">${product.price}</span>
            </div>
            <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="icon-close"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M6 18L18 6M6 6l12 12"
                />
            </svg>
        `;

		rowProduct.append(containerProduct);

		total =
			total + parseInt(product.quantity * product.price.slice(1));
		totalOfProducts = totalOfProducts + product.quantity;
	});

	valorTotal.innerText = `$${total}`;
	countProducts.innerText = totalOfProducts;
};
</script>